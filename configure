#!/bin/bash

set -eu

main () {
    initialize_submodules
    create_virtualenv
    install_cffi
    build_libargon2
    install_requirements
}

initialize_submodules () {
    git submodule init
    git submodule update
}

create_virtualenv () {
    virtualenv venv -p $(which python3)
}

install_cffi () {
    ./venv/bin/pip install cffi
}

build_libargon2 () {
    ./venv/bin/python setup.py build
}

install_requirements () {
    ./venv/bin/pip install -e .[test]
}

main
